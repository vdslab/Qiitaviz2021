{"version":3,"sources":["ZoomableSVG.js","D3DirectedGraph.js","components/AreaTab.js","components/Search.js","components/Header.js","App.js","index.js"],"names":["ZoomableSVG","children","svgRef","width","height","useRef","useState","k","setK","x","setX","y","setY","useEffect","zoom","d3","on","event","transform","scaleExtent","current","call","ref","className","style","display","marginLeft","marginRight","D3DirectedGraph","articleData","setArticleData","loading","setLoading","nodes","setNodes","links","setLinks","displayArticle","setDisplayArticle","mousePosition","setMousePosition","deviceWidth","window","innerWidth","svgWidth","svgHeight","overHandle","e","target","currentTarget","dataset","name","data","filter","item","type","positionX","pageX","positionY","pageY","startSimulation","simulation","force","radius","d","r","iterations","distance","id","strength","tick","stop","slice","a","fetch","response","json","Array","push","ID","label","nodeName","url","childNode","child","source","startLineChart","marginTop","marginBottom","viewBox","refX","refY","orient","markerWidth","markerHeight","xoverflow","fill","stroke","map","link","strokeWidth","markerEnd","x1","y1","x2","y2","node","cx","cy","data-url","data-name","onMouseEnter","textAnchor","fontSize","length","position","left","top","onMouseLeave","i","href","title","AreaTab","aria-haspopup","aria-controls","role","Search","placeholder","Header","App","render","document","querySelector"],"mappings":"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","file":"static/js/main.66ba64f0.chunk.js","sourcesContent":["import { useEffect, useRef, useState } from \"react\";\nimport * as d3 from \"d3\";\nimport { autoType } from \"d3\";\n\nfunction ZoomableSVG({ children, width, height }) {\n  const svgRef = useRef();\n  const [k, setK] = useState(1);\n  const [x, setX] = useState(0);\n  const [y, setY] = useState(0);\n  useEffect(() => {\n    const zoom = d3.zoom().on(\"zoom\", (event) => {\n      const { x, y, k } = event.transform;\n      setK(k);\n      setX(x);\n      setY(y);\n    });\n    zoom.scaleExtent([0.5, 2]);\n    d3.select(svgRef.current).call(zoom);\n  }, []);\n  return (\n    <svg\n      ref={svgRef}\n      width={\"100%\"}\n      height={\"100%\"}\n      className=\"has-background-white\"\n      style={{\n        display: \"block\",\n        marginLeft: \"auto\",\n        marginRight: \"auto\",\n      }}\n    >\n      <g transform={`translate(${x}, ${y})scale(${k})`}>{children}</g>\n    </svg>\n  );\n}\n\nexport default ZoomableSVG;\n","import * as d3 from \"d3\";\r\nimport \"bulma/css/bulma.css\";\r\nimport { useState, useEffect } from \"react\";\r\nimport ZoomableSVG from \"./ZoomableSVG\";\r\nimport Footer from \"./components/Footer\";\r\n\r\nfunction D3DirectedGraph() {\r\n  // 仮の記事データ\r\n  const MOBILE_BORDER_SIZE = 599;\r\n\r\n  const [articleData, setArticleData] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [nodes, setNodes] = useState([]);\r\n  const [links, setLinks] = useState([]);\r\n  // おすすめ記事\r\n  const [displayArticle, setDisplayArticle] = useState([]);\r\n  const [mousePosition, setMousePosition] = useState([]);\r\n\r\n  // デバイスの横幅を取得\r\n  const { innerWidth: deviceWidth } = window;\r\n  const svgWidth = deviceWidth * 0.66;\r\n  const svgHeight = deviceWidth <= MOBILE_BORDER_SIZE ? 1500 : 1100;\r\n\r\n  function overHandle(e) {\r\n    const target = e.currentTarget.dataset.name;\r\n    const data = articleData.filter((item) => {\r\n      return item.type == target;\r\n    });\r\n    const positionX = deviceWidth <= MOBILE_BORDER_SIZE ? \"500\" : e.pageX;\r\n    const positionY = e.pageY;\r\n\r\n    setDisplayArticle(data);\r\n    setMousePosition([positionX, positionY]);\r\n  }\r\n  function outHandle(e) {\r\n    setDisplayArticle([]);\r\n  }\r\n\r\n  useEffect(() => {\r\n    const startSimulation = (nodes, links) => {\r\n      const linkLen = 150;\r\n      const simulation = d3\r\n        .forceSimulation()\r\n        .force(\r\n          \"collide\",\r\n          d3\r\n            .forceCollide()\r\n            .radius(function (d) {\r\n              return d.r;\r\n            })\r\n            .iterations(16)\r\n        ) //衝突値の設定\r\n        .force(\r\n          \"link\",\r\n          d3\r\n            .forceLink()\r\n            .distance((d) => linkLen)\r\n            .id((d) => d.id)\r\n        ) //stength:linkの強さ（元に戻る力 distance: linkの長さ\r\n        .force(\"charge\", d3.forceManyBody().strength(-500)) //引き合う力を設定。\r\n        .force(\"center\", d3.forceCenter(svgWidth / 2, svgHeight / 2)) //描画するときの中心を設定\r\n        .force(\r\n          \"x\",\r\n          d3\r\n            .forceX()\r\n            .x(svgWidth / 2)\r\n            .strength(0.1)\r\n        ); //x方向に戻る力\r\n\r\n      simulation\r\n        // forceSimulationの影響下にnodesを置く\r\n        .nodes(nodes);\r\n\r\n      // linkデータをセット\r\n      simulation.force(\"link\").links(links);\r\n      simulation.tick(300).stop();\r\n\r\n      setNodes(nodes.slice());\r\n      setLinks(links.slice());\r\n    };\r\n\r\n    const startLineChart = async () => {\r\n      const [nodes, links] = await (async () => {\r\n        const response = await fetch(\"./data/new_data.json\");\r\n        const data = await response.json();\r\n        const nodes = Array();\r\n        const links = Array();\r\n\r\n        const r = 35;\r\n        for (const item of data) {\r\n          nodes.push({\r\n            id: item.ID, //nodeのindexを標準設定から変更\r\n            label: item.nodeName,\r\n            url: item.url,\r\n            r,\r\n          });\r\n\r\n          for (const child of item.childNode) {\r\n            links.push({\r\n              source: item.ID,\r\n              target: child,\r\n            });\r\n          }\r\n        }\r\n\r\n        return [nodes, links];\r\n      })();\r\n      setArticleData(\r\n        await (async () => {\r\n          const response = await fetch(\"article_data.json\");\r\n          const data = await response.json();\r\n          return data;\r\n        })()\r\n      );\r\n\r\n      startSimulation(nodes, links);\r\n      setLoading(false);\r\n    };\r\n    startLineChart();\r\n  }, []);\r\n\r\n  const arrowEdgeX = -35;\r\n  const arrowEdgeY = -5;\r\n  const arrowHeight = 10;\r\n  const arrowWidth = 14;\r\n  const arrowEdgeEnd = -25;\r\n\r\n  if (loading) {\r\n    return <div>loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className=\"columns is-mobile\"\r\n      style={{\r\n        height: \"80vh\",\r\n        marginRight: \"20px\",\r\n        marginLeft: \"20px\",\r\n        marginTop: \"20px\",\r\n      }}\r\n    >\r\n      <div className=\"column is-8 box\" style={{ marginBottom: \"0\" }}>\r\n        <ZoomableSVG width={svgWidth} height={svgHeight}>\r\n          <defs>\r\n            <marker\r\n              id=\"arrowhead\"\r\n              viewBox={`${arrowEdgeX} ${arrowEdgeY} ${arrowWidth} ${arrowHeight}`}\r\n              refX=\"13\"\r\n              refY=\"0\"\r\n              orient=\"auto\"\r\n              markerWidth=\"13\"\r\n              markerHeight=\"13\"\r\n              xoverflow=\"visible\"\r\n            >\r\n              <path\r\n                d={`M ${arrowEdgeX} ${arrowEdgeY} L ${arrowEdgeEnd} 0 L ${arrowEdgeX} ${\r\n                  -1 * arrowEdgeY\r\n                }`}\r\n                fill=\"#999\"\r\n                style={{ stroke: \"none\" }}\r\n              ></path>\r\n            </marker>\r\n          </defs>\r\n\r\n          <g className=\"links\">\r\n            {links.map((link) => {\r\n              return (\r\n                <line\r\n                  key={link.source.id + \"-\" + link.target.id}\r\n                  stroke=\"black\"\r\n                  strokeWidth=\"1\"\r\n                  className=\"link\"\r\n                  markerEnd=\"url(#arrowhead)\"\r\n                  id=\"edgepath0\"\r\n                  x1={link.source.x}\r\n                  y1={link.source.y}\r\n                  x2={link.target.x}\r\n                  y2={link.target.y}\r\n                ></line>\r\n              );\r\n            })}\r\n          </g>\r\n\r\n          <g className=\"nodes\">\r\n            {nodes.map((node) => {\r\n              return (\r\n                <g className=\"nodes\" key={node.id}>\r\n                  <circle\r\n                    className=\"node\"\r\n                    r={node.r}\r\n                    style={{ fill: \"rgb(128, 255, 191)\" }}\r\n                    cx={node.x}\r\n                    cy={node.y}\r\n                    data-url={node.url}\r\n                    data-name={node.label}\r\n                    onMouseEnter={overHandle}\r\n                  ></circle>\r\n\r\n                  <text\r\n                    className=\"node-label\"\r\n                    textAnchor=\"middle\"\r\n                    fill=\"black\"\r\n                    fontSize={\r\n                      deviceWidth <= MOBILE_BORDER_SIZE ? \"15px\" : \"15px\"\r\n                    }\r\n                    x={node.x}\r\n                    y={node.y}\r\n                  >\r\n                    {node.label}\r\n                  </text>\r\n                </g>\r\n              );\r\n            })}\r\n          </g>\r\n        </ZoomableSVG>\r\n      </div>\r\n      <div\r\n        className={displayArticle.length > 0 ? \"card show popup\" : \"card popup\"}\r\n        style={{\r\n          position: \"absolute\",\r\n          left: mousePosition[0],\r\n          top: mousePosition[1],\r\n        }}\r\n        onMouseLeave={outHandle}\r\n      >\r\n        <div className=\"card-content\">\r\n          <div className=\"content\">\r\n            <p>おすすめの記事</p>\r\n            {displayArticle.map((item, i) => {\r\n              return (\r\n                <p key={i}>\r\n                  <a href={item.url} target=\"_blank\">\r\n                    {item.title}\r\n                  </a>\r\n                </p>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"column is-4 box\">\r\n        <p>サブビュー</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nexport default D3DirectedGraph;\r\n","import \"bulma/css/bulma.css\";\n\nfunction AreaTab() {\n  return (\n    <div className=\"column is-5-mobile is-2-desktop\">\n      <div className=\"dropdown is-hoverable\">\n        <div className=\"dropdown-trigger\">\n          <button\n            className=\"button\"\n            aria-haspopup=\"true\"\n            aria-controls=\"dropdown-menu\"\n          >\n            <span>領域を選択</span>\n            <span className=\"icon is-small\">\n              <i className=\"fas fa-angle-down\"></i>\n            </span>\n          </button>\n        </div>\n        <div className=\"dropdown-menu\" id=\"dropdown-menu\" role=\"menu\">\n          <div className=\"dropdown-content\">\n            <a href=\"#\" className=\"dropdown-item\">\n              Web\n            </a>\n            <a href=\"#\" className=\"dropdown-item\">\n              IOS\n            </a>\n            <a href=\"#\" className=\"dropdown-item\">\n              Android\n            </a>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default AreaTab;\n","import \"bulma/css/bulma.css\";\n\nfunction Search() {\n  return (\n    <div className=\"column\">\n      <div className=\"field has-addons\" style={{}}>\n        <div className=\"control\">\n          <input\n            className=\"input\"\n            type=\"text\"\n            name=\"search\"\n            placeholder=\"タグを検索\"\n          />\n        </div>\n        <div className=\"control\">\n          <a className=\"button is-success\">\n            <i className=\"fa fa-search\"></i>検索\n          </a>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Search;\n","import \"bulma/css/bulma.css\";\nimport AreaTab from \"./AreaTab\";\nimport Search from \"./Search\";\nfunction Header() {\n  return (\n    <div className=\"hero is-small is-primary\" style={{ height: \"10vh\" }}>\n      <section className=\"section hero-body\">\n        <div className=\"container\">\n          <div className=\"columns is-mobile\">\n            <div className=\"column is-3-mobile\">\n              <h1 className=\"title is-size-3-desktop is-size-7-mobile has-text-centered\">\n                QiitaViz-legends\n              </h1>\n            </div>\n            <AreaTab />\n            <Search />\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}\n\nexport default Header;\n","import D3DirectedGraph from \"./D3DirectedGraph\";\nimport \"bulma/css/bulma.css\";\nimport Header from \"./components/Header\";\nconst App = () => {\n  return (\n    <div>\n      <Header />\n      <section>\n        <D3DirectedGraph />\n      </section>\n    </div>\n  );\n};\n\nexport default App;\n","import { render } from \"react-dom\";\nimport App from \"./App\";\n\nrender(<App />, document.querySelector(\"#content\"));"],"sourceRoot":""}